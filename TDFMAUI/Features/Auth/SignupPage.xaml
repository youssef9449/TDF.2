<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:helpers="clr-namespace:TDFMAUI.Helpers"
             xmlns:local="clr-namespace:TDFMAUI.Features.Auth"
             x:DataType="local:SignupViewModel"
             x:Class="TDFMAUI.Features.Auth.SignupPage"
             Title="Signup"
             BackgroundColor="{Binding Source={x:Static helpers:ThemeHelper.CurrentTheme}, Converter={StaticResource ThemeToBackgroundColorConverter}}">

    <ContentPage.Resources>
        <Style x:Key="EntryStyle" TargetType="Entry">
            <Setter Property="TextColor" Value="{StaticResource TextColor}" />
            <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#F5F5F7, Dark={StaticResource DarkSurfaceVariant}}" />
            <Setter Property="PlaceholderColor" Value="{AppThemeBinding Light=#999999, Dark={StaticResource DarkTextTertiary}}" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="HeightRequest" Value="45" />
            <Setter Property="ClearButtonVisibility" Value="WhileEditing" />
        </Style>
        <Style x:Key="PickerStyle" TargetType="Picker">
            <Setter Property="TextColor" Value="{StaticResource TextColor}" />
            <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#F5F5F7, Dark={StaticResource DarkSurfaceVariant}}" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="HeightRequest" Value="45" />
        </Style>
    </ContentPage.Resources>

    <!-- Responsive layout with ScrollView to ensure all content is visible -->
    <ScrollView>
        <Grid>
            <Label Text="Desktop Layout" IsVisible="{x:Static helpers:DeviceHelper.IsDesktop}" 
                   HorizontalOptions="End" VerticalOptions="Start" Margin="0,10,10,0" FontSize="10" TextColor="{StaticResource Gray600}"/>
            <Label Text="Mobile Layout" IsVisible="{x:Static helpers:DeviceHelper.IsMobile}" 
                   HorizontalOptions="End" VerticalOptions="Start" Margin="0,10,10,0" FontSize="10" TextColor="{StaticResource Gray600}"/>
            <Grid RowDefinitions="Auto,*,Auto" ColumnDefinitions="1*,Auto,1*" Margin="0,20,0,20">
                <!-- Left column spacer -->
                <BoxView Grid.Column="0" Grid.RowSpan="3" />

                <!-- Main content - improved desktop layout -->
                <Frame Grid.Column="1" Grid.Row="1"
                       Padding="{OnPlatform Default=32, WinUI=48}"
                       Margin="0,0,0,0"
                       HasShadow="True"
                       CornerRadius="18"
                       BorderColor="{StaticResource BorderColor}"
                       BackgroundColor="{AppThemeBinding Light=White, Dark={StaticResource DarkSurfaceVariant}}"
                       MinimumWidthRequest="{OnPlatform Default=420, WinUI=520}"
                       MaximumWidthRequest="{OnPlatform Default=650, WinUI=700}"
                       HorizontalOptions="Center"
                       VerticalOptions="Center">
                    <VerticalStackLayout Spacing="16">
                        <Label x:Name="TitleLabel" Text="Create Account" 
                               TextColor="{StaticResource TextColor}"
                               FontSize="{OnPlatform Default=28, WinUI=32}"
                               HorizontalOptions="Center" Margin="0,0,0,15" />

                        <!-- Form fields with better spacing -->
                        <Entry Placeholder="Username" Text="{Binding Username}" Style="{StaticResource EntryStyle}" 
                               Margin="0,5,0,5" />
                        <Entry Placeholder="Password" IsPassword="True" Text="{Binding Password}" Style="{StaticResource EntryStyle}" 
                               Margin="0,5,0,5" />
                        <Entry Placeholder="Confirm Password" IsPassword="True" Text="{Binding ConfirmPassword}" Style="{StaticResource EntryStyle}" 
                               Margin="0,5,0,5" />
                        <Entry Placeholder="Full Name" Text="{Binding FullName}" Style="{StaticResource EntryStyle}" 
                               Margin="0,5,0,10" />

                        <Label Text="Department" TextColor="{StaticResource TextColor}" Margin="0,5,0,0" />
                        <Picker Title="Select Department"
                                ItemsSource="{Binding Departments}"
                                ItemDisplayBinding="{Binding Name}"
                                SelectedItem="{Binding SelectedDepartment}"
                                Style="{StaticResource PickerStyle}"
                                Margin="0,0,0,5"
                                IsEnabled="{Binding Departments.Count, Converter={StaticResource IntToBoolConverter}}" />

                        <Label Text="Title" TextColor="{StaticResource TextColor}" Margin="0,5,0,0" />
                        <Picker Title="Select Title"
                                ItemsSource="{Binding Titles}"
                                SelectedItem="{Binding SelectedTitle}"
                                Style="{StaticResource PickerStyle}"
                                Margin="0,0,0,10"
                                IsEnabled="{Binding Titles.Count, Converter={StaticResource IntToBoolConverter}}" />

                        <Button Text="Sign Up" 
                                Command="{Binding SignupCommand}" 
                                TextColor="White"
                                FontAttributes="Bold"
                                BackgroundColor="{StaticResource Primary}"
                                Margin="0,15,0,10" 
                                HeightRequest="50" />

                        <Label Text="{Binding ErrorMessage}" 
                               TextColor="{AppThemeBinding Light=#FF3B30, Dark=#FF6B60}"
                               IsVisible="{Binding HasError}" 
                               HorizontalOptions="Center" HeightRequest="20" Margin="0,5,0,5" />

                        <Button Text="Already have an account? Login" Command="{Binding GoToLoginCommand}" 
                                BackgroundColor="Transparent" 
                                TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource White}}" 
                                HorizontalOptions="Center" HeightRequest="45" Margin="0,10,0,0"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Right column spacer -->
                <BoxView Grid.Column="2" Grid.RowSpan="3" />
            </Grid>
        </Grid>
    </ScrollView>
</ContentPage>